---
title: "Hazel Valley Elementary School"
subtitle: "Fall 2020 and Winter 2021 Social-Emotional Learning Survey Results" 
author: "James Lamar Foster"
output: rmdformats::material
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#clear memory
rm(list = ls())
#penalize excessive significant figures
options(digits = 3)
#preventing scientific notation
options(scipen = 10)

#packages used in this analysis, will install packages if not installed
if(!require(knitr)){
    install.packages("knitr", dependencies = TRUE)
    library(knitr)
}
if(!require(tidyverse)){
    install.packages("tidyverse", dependencies = TRUE)
    library(tidyverse)
}
if(!require(haven)){
    install.packages("haven", dependencies = TRUE)
    library(haven)
}
if(!require(janitor)){
    install.packages("janitor", dependencies = TRUE)
    library(janitor)
}

if(!require(ggthemes)){
    install.packages("ggthemes", dependencies = TRUE)
    library(ggthemes)
}

if(!require(readxl)){
    install.packages("readxl", dependencies = TRUE)
    library(readxl)
}

library(RColorBrewer)
library(ggalt)
library(ggrepel)
library(kableExtra)
library(waffle)
library(cowplot)
library(patchwork)
```

```{r set_knitr_chunk_options, echo=FALSE, message=FALSE}
#set global output chunk options
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, collapse = F, highlight = F, results = "asis")
```

```{r}
#Reading in the data 
winter <- readxl::read_xlsx("sel_indicators_survey.xlsx", sheet = 1)
fall <- readxl::read_xlsx("sel_indicators_survey.xlsx", sheet = 2)
demo <- readxl::read_xlsx("sel_indicators_survey.xlsx", sheet = 3)

theme_set(theme_classic())
```

```{r}
#Some quick data cleaning
# Winter sheet 
winter <- winter %>% 
  select(-c(1)) %>% 
  clean_names() %>% 
  rename(
    sid = 1,
    belong = 2,
    `trust adult` = 3,
    `voice matters` = 4,
    `excited to learn` = 5, 
    `peers care` = 6,
    `I care about peers` = 7,
    `teachers care` = 8,
    `stuck strategies` = 9,
    `upset strategies` = 10,
    `problem-solving strategies` = 11,
    `share strategies with family` = 12,
    `Wants school adult` = 13) %>% 
  mutate(
    quarter = "W. '21")

# Fall sheet 
fall <- fall %>% 
  select(-c(1)) %>% 
  clean_names() %>% 
  rename(
    sid = 1,
    belong = 2,
    `trust adult` = 3,
    `voice matters` = 4,
    `excited to learn` = 5, 
    `peers care` = 6,
    `I care about peers` = 7,
    `teachers care` = 8,
    `stuck strategies` = 9,
    `upset strategies` = 10,
    `problem-solving strategies` = 11,
    `share strategies with family` = 12,
    `Wants school adult` = 13) %>% 
  mutate(
    quarter = "F. '20")

# combine fall and winter data set 
wf <- rbind(winter, fall)

# only keep numbers in SID column 
wf <- wf %>% 
  mutate(sid = parse_number(wf$sid, trim_ws = T))

# Clean demo names 
demo <- demo %>% 
  clean_names() %>% 
  rename(
    `home language` = 3,
     gender = gen)

# Match WF dataset to demographic dataset 
sel_df <- left_join(wf, demo, by = "sid") 

#Change likert scale to numbers 
sel_df[sel_df == "Siempre // Always"] <- "3"
sel_df[sel_df == "Casi Siempre // Usually"] <- "2" 
sel_df[sel_df == "De Vez En Cuando // Sometimes"] <- "1" 
sel_df[sel_df == "Nunca // Never"] <- "0"
sel_df[sel_df == "Si // Yes"] <- "1"
sel_df[sel_df == "No"] <- "0"

sel_df[sel_df == "Black or African American"] <- "Black or AA"
sel_df[sel_df == "Native Hawaiian or Other Pacific Islander"] <- "NHPI" 
sel_df[sel_df == "American Indian or Alaska Native"] <- "AIAN" 

# clean names
sel_df <- clean_names(sel_df) 

#Use the hablar package to change character variables that should be integer/numeric to interger
sel_df <- sel_df %>% hablar::retype() 

sel_long <- sel_df %>% pivot_longer(cols = belong:wants_school_adult, names_to = "domain", values_to = "score")

# remove underscores from strings in domain column
sel_long$domain <- str_replace_all(sel_long$domain, "_", " ")

# Make some varibles factors in wf data set 

# Change observation Names 
wf[wf == "Siempre // Always"] <- "Siempre"
wf[wf == "Casi Siempre // Usually"] <- "Casi Siempre" 
wf[wf == "De Vez En Cuando // Sometimes"] <- "De Vez En Cuando" 
wf[wf == "Nunca // Never"] <- "Nunca"
wf[wf == "Si // Yes"] <- "Si"

# Make some columns factors in wf dataframe 
wf <- wf %>% mutate_if(is.character, as.factor)

# Change factor levels
wf$belong <- factor(wf$belong, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`trust adult` <- factor(wf$`trust adult`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`voice matters` <- factor(wf$`voice matters`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`excited to learn` <- factor(wf$`excited to learn`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`peers care` <- factor(wf$`peers care`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`teachers care` <- factor(wf$`teachers care`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`I care about peers` <- factor(wf$`I care about peers`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`stuck strategies` <- factor(wf$`stuck strategies`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`upset strategies` <- factor(wf$`upset strategies`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`problem-solving strategies` <- factor(wf$`problem-solving strategies`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$`share strategies with family` <- factor(wf$`share strategies with family`, levels = c("Nunca", "De Vez En Cuando", "Casi Siempre", "Siempre"))
wf$quarter <- factor(wf$quarter, levels = c("W. '21", "F. '20"))
```

```{r, eval= FALSE}
# Make Excel Spreadsheet 
winter <- winter %>% 
  mutate(Quarter = "Winter", Year = "2021") 
fall <- fall %>% 
  mutate(Quarter = "Fall", Year = "2020") 
rbind(winter, fall) %>% 
  rename("SID" = `Email Address`) %>%
  mutate(SID = parse_number(SID, trim_ws = T)) %>% 
  left_join(demo, by = "SID") %>% 
  write_csv("sel_indicators_survey_Demo.csv")
```

![](HZ_Hornet.jpeg)

# Demographic Data 

## Gender 
```{r}
# Fall Gender 
table <- sel_df %>%
  filter(quarter == "F. '20") %>%
  filter(!is.na(gender)) %>% 
  count("Gender" = gender ) %>%
  adorn_percentages(denominator = "col") %>% 
  adorn_totals("row") %>% 
  adorn_pct_formatting() %>%
  adorn_ns()

kable(table, caption = "Fall 2020 SEL Survey Respondents' Gender", col.names = c("Gender", "Percent (Total)"))%>% kable_styling(full_width = T, bootstrap_options = c("striped", "responsive"), position = "left", fixed_thead = T) %>% row_spec(c(3), bold = T, color = "#049E64")  
```

```{r}
# Winter Gender 
table <- sel_df %>%
  filter(quarter == "W. '21") %>%
  filter(!is.na(gender)) %>% 
   count("Gender" = gender ) %>%
   adorn_percentages(denominator = "col") %>% 
   adorn_totals("row") %>% 
  adorn_pct_formatting() %>%
  adorn_ns()

kable(table, caption = "Winter 2021 SEL Survey Respondents' Gender", col.names = c("Gender", "Percent (Total)"))%>% kable_styling(full_width = T, bootstrap_options = c("striped", "responsive"), position = "left", fixed_thead = T) %>% row_spec(c(3), bold = T, color = "#049E64") 
```

```{r}
sel_df %>% 
  filter(!is.na(gender)) %>% 
ggplot(aes(x= reorder(gender, home_language,function(x)length(x)), fill= quarter)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#049E64", "#DFB312", name="Semester")) + coord_flip() + labs(x= "", fill = "Semester")
```

## Race
```{r}
# Fall Race 
table <- sel_df %>%
  filter(quarter == "F. '20") %>%
  filter(!is.na(race)) %>% 
   count("Race" = race ) %>%
   arrange(desc(n)) %>% 
   adorn_totals("row") %>% 
   adorn_percentages(denominator = "col") %>% 
  adorn_pct_formatting() %>%
  adorn_ns()

kable(table, caption = "Fall 2020 SEL Survey Respondents' Race", col.names = c("Race", "Percent (Total)"))%>% kable_styling(full_width = T, bootstrap_options = c("striped", "responsive"), position = "left", fixed_thead = T) %>% row_spec(c(8), bold = T, color = "#049E64")  
```

```{r}
# Winter Race 
table <- sel_df %>%
  filter(quarter == "W. '21") %>% 
  filter(!is.na(race)) %>% 
   count("Race" = race ) %>%
   arrange(desc(n)) %>% 
   adorn_totals("row") %>% 
   adorn_percentages(denominator = "col") %>% 
  adorn_pct_formatting() %>%
  adorn_ns()

kable(table, caption = "Winter 2021 SEL Survey Respondents' Race", col.names = c("Race", "Percent (Total)"), subcaption = "blue is new") %>% kable_styling(full_width = T, bootstrap_options = c("striped", "responsive"), position = "left", fixed_thead = T) %>% row_spec(c(8), bold = T, color = "#049E64") 
```

```{r}
sel_df %>% 
  filter(!is.na(race)) %>% 
ggplot(aes(x= reorder(race, quarter,FUN = length), fill= quarter)) + geom_bar(position = "dodge") + coord_flip() + labs(x= "", fill = "Semester") + scale_fill_manual(values=c("#049E64", "#DFB312", name="Semester"))
```

## Home Language
```{r}
# Fall Language 
table <- sel_df %>%
  filter(quarter == "F. '20") %>% 
  filter(!is.na(home_language)) %>% 
   count("Home Language" = home_language ) %>%
   arrange(desc(n)) %>% 
   adorn_totals("row") %>% 
   adorn_percentages(denominator = "col") %>% 
  adorn_pct_formatting() %>%
  adorn_ns()

kable(table, caption = "Fall 2020 SEL Survey Respondents' Home Language", col.names = c("Home Language", "Percent (Total)"))%>% kable_styling(full_width = T, bootstrap_options = c("striped", "responsive"), position = "left", fixed_thead = T) %>% row_spec(c(13), bold = T, color = "#049E64")  
```

```{r}
# Winter Language 
table <- sel_df %>%
  filter(quarter == "W. '21") %>% 
  filter(!is.na(home_language)) %>% 
   count("Home Language" = home_language ) %>%
   arrange(desc(n)) %>% 
   adorn_totals("row") %>% 
   adorn_percentages(denominator = "col") %>% 
  adorn_pct_formatting() %>%
  adorn_ns()

kable(table, caption = "Winter 2021 SEL Survey Respondents' Home Language", col.names = c("Home Language", "Percent (Total)"), subcaption = "blue is new") %>% kable_styling(full_width = T, bootstrap_options = c("striped", "responsive"), position = "left", fixed_thead = T) %>% row_spec(c(10), bold = T, color = "#049E64") 
```

```{r}
sel_df %>% 
  filter(!is.na(home_language)) %>% 
ggplot(aes(x= reorder(home_language, quarter,FUN = length), fill= quarter)) + geom_bar(position = "dodge") + coord_flip() + labs(x= "", fill = "Semester") + scale_fill_manual(values=c("#049E64", "#DFB312", name="Semester"))
```

# Social-Emotional Learning (SEL) Survey Responses 

This section contains three sub-sections of questions centered on caring, SEL strategies, and other SEL questions asked on the student survey  

## Caring Questions 

```{r}
# Peers care
a <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`peers care`)) %>% 
  count(`peers care`) %>% 
  summarise(`peers care`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `peers care`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Estudiantes se preocupan por mí y me tratan con amabilidad", subtitle = "Students care about me and treat me with kindness") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= ifelse(Percent > "0.05",scales::percent(Percent), "")), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")

legend <- get_legend(a + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom"))
```

```{r}
# I Care
b <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`I care about peers`)) %>% 
  count(`I care about peers`) %>% 
  summarise(`I care about peers`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `I care about peers`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Me preocupo por los demás y los trato con amabilidad", subtitle = "I care about students and treat them with kindness") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= ifelse(Percent > "0.05",scales::percent(Percent), "")), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
# Teachers Care 
c <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`teachers care`)) %>% 
  count(`teachers care`) %>% 
  summarise(`teachers care`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `teachers care`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Mis maestros se preocupan por mí y me tratan con amabilidad", caption = "values less than 5% are not shown", subtitle = "My teachers care about me and treat me with kindness") + scale_fill_brewer(palette = "Dark2") + geom_text(aes(label= ifelse(Percent > "0.05",scales::percent(Percent), "")), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
a + b + c + legend + plot_layout(ncol = 1)
```

### Caring Overall Average Growth 
```{r}
# Overall 
sel_long %>% 
  filter(str_detect(domain, "care")) %>% 
  group_by(domain, quarter) %>% 
  summarise(y= round(mean(score, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = domain, group = domain)) + labs(title= "", x = "", y = "", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~domain) + geom_text(aes(label = y), vjust = -.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

### Caring Average Growth by Gender
```{r}
sel_long %>% 
  filter(str_detect(domain, "care")) %>% 
  filter(!is.na(gender)) %>% 
  filter(domain != "wants school adult") %>% 
  group_by(domain, quarter, gender) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,x = "", y = "Average Rating", color = "",  caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3", subtitle = "dotted lines indicate overall average of Fall and Winter") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always"))  + geom_point() + geom_line() + facet_wrap(~gender) + scale_color_brewer(palette = "Dark2") + theme(legend.position = "bottom") + geom_hline(yintercept = 2.54, color = "#1B9E77", linetype = "dashed") + geom_hline(yintercept = 2, color = "#D95F02", linetype = "dashed") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

### Caring Average Growth by Race 
```{r}
sel_long %>% 
  filter(str_detect(domain, "care")) %>% 
  filter(!is.na(race)) %>% 
  filter(domain != "wants school adult") %>% 
  group_by(domain, quarter, race) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,x = "", y = "Average Rating", color = "",  caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3", subtitle = "dotted lines indicate overall average of Fall and Winter") + scale_y_continuous(limits = c(0,3))  + geom_point() + geom_line() + facet_wrap(~race) + scale_color_brewer(palette = "Dark2") + theme(legend.position = "bottom") + geom_hline(yintercept = 2.54, color = "#1B9E77", linetype = "dashed") + geom_hline(yintercept = 2, color = "#D95F02", linetype = "dashed") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

### Caring Average Growth by Race and Gender 
```{r}
sel_long %>% 
  filter(str_detect(domain, "care")) %>% 
  filter(!is.na(race)) %>% 
  filter(!is.na(gender)) %>% 
  filter(domain != "wants school adult") %>% 
  group_by(domain, quarter, race, gender) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,x = "", y = "Average Rating", color = "",  caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3", subtitle = "dotted lines indicate overall average of Fall and Winter") + scale_y_continuous(limits = c(0,3))  + geom_point() + geom_line() + facet_wrap(~race + gender) + scale_color_brewer(palette = "Dark2") + theme(legend.position = "bottom") + geom_hline(yintercept = 2.54, color = "#1B9E77", linetype = "dashed") + geom_hline(yintercept = 2, color = "#D95F02", linetype = "dashed") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

## Social-Emotional Learning Strategies Questions  
```{r}
# `stuck strategies` 
a <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`stuck strategies` )) %>% 
  count(`stuck strategies` ) %>% 
  summarise(`stuck strategies` , "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `stuck strategies` )) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Tengo estrategias para despegarme", subtitle = "If I get stuck, I choose an effective strategy to succeed") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= ifelse(Percent > "0.05",scales::percent(Percent), "")), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")

legend <- get_legend(a + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom"))
```

```{r}
# `upset strategies`
b <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`upset strategies`)) %>% 
  count(`upset strategies`) %>% 
  summarise(`upset strategies`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `upset strategies`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Tengo estrategias para calmarme cuando estoy molesto", subtitle = "If I get upset, I choose an effective strategy to calm down", caption = "values less than 5% are not shown") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= ifelse(Percent > "0.05",scales::percent(Percent), "")), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
# `problem-solving strategies`
c <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`problem-solving strategies`)) %>% 
  count(`problem-solving strategies`) %>% 
  summarise(`problem-solving strategies`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `problem-solving strategies`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Conozco muchas estrategias para solucionar problemas", subtitle = "I know many strategies to solve problems") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= ifelse(Percent > "0.05",scales::percent(Percent), "")), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
# `share strategies with family`
d <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`share strategies with family`)) %>% 
  count(`share strategies with family`) %>% 
  summarise(`share strategies with family`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `share strategies with family`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Comparto con mi familia las estrategias que he aprendido", caption = "values less than 5% are not shown", subtitle = "I share strategies I have learned with my family") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= ifelse(Percent > "0.05",scales::percent(Percent), "")), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
a + b + legend + plot_layout(ncol = 1)
```

```{r}
c + d + legend + plot_layout(ncol = 1)
```

### SEL Strategies Overall Average Growth 
```{r}
# Overall Average SEL Strategies 
sel_long %>% 
  filter(str_detect(domain, "strategies")) %>% 
  group_by(domain, quarter) %>% 
  summarise(y= round(mean(score, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = domain, group = domain)) + labs(title= "", x = "", y = "", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~domain) + geom_text(aes(label = y), vjust = -.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

### SEL Strategies Average Growth by Gender
```{r}
#Average SEL Domain by Gender 
sel_long %>% 
  filter(str_detect(domain, "strategies")) %>% 
  filter(domain != "wants school adult") %>% 
  filter(!is.na(gender)) %>% 
  group_by(domain, quarter, gender) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,subtitle = "dotted lines indicate overall average of Fall and Winter", x = "", y = "Average Rating", color = "",  caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always"))  + geom_point() + geom_line() + facet_wrap(~gender) + scale_color_brewer(palette = "Dark2") + theme(legend.position = "bottom") + geom_hline(yintercept = 2.06, color = "#1B9E77", linetype = "dashed") + geom_hline(yintercept = 1.73, color = "#D95F02", linetype = "dashed") + geom_hline(yintercept = 2.05, color = "#7570B3", linetype = "dashed") + geom_hline(yintercept = 2.04, color = "#E7298A", linetype = "dashed") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold")) + guides(color = guide_legend(nrow = 2, byrow = TRUE))
```

### SEL Strategies Average Growth by Race
```{r}
sel_long %>% 
  filter(str_detect(domain, "strategies")) %>% 
  filter(domain != "wants school adult") %>% 
  filter(!is.na(race)) %>% 
  group_by(domain, quarter, race) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,subtitle = "dotted lines indicate overall average of Fall and Winter", x = "", y = "Average Rating", color = "",  caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3))  + geom_point() + geom_line() + facet_wrap(~race) + scale_color_brewer(palette = "Dark2") + theme(legend.position = "bottom") + geom_hline(yintercept = 2.06, color = "#1B9E77", linetype = "dashed") + geom_hline(yintercept = 1.73, color = "#D95F02", linetype = "dashed") + geom_hline(yintercept = 2.05, color = "#7570B3", linetype = "dashed") + geom_hline(yintercept = 2.04, color = "#E7298A", linetype = "dashed") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold")) + guides(color = guide_legend(nrow = 2, byrow = TRUE))
```

### SEL Strategies Average Growth by Race and Gender
```{r}
sel_long %>% 
  filter(str_detect(domain, "strategies")) %>% 
  filter(domain != "wants school adult") %>% 
  filter(!is.na(race)) %>% 
  filter(!is.na(gender)) %>% 
  group_by(domain, quarter, race, gender) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "", subtitle = "dotted lines indicate overall average of Fall and Winter", x = "", y = "Average Rating", color = "",  caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3))  + geom_point() + geom_line() + facet_wrap(~race + gender) + scale_color_brewer(palette = "Dark2") + theme(legend.position = "bottom") + geom_hline(yintercept = 2.06, color = "#1B9E77", linetype = "dashed") + geom_hline(yintercept = 1.73, color = "#D95F02", linetype = "dashed") + geom_hline(yintercept = 2.05, color = "#7570B3", linetype = "dashed") + geom_hline(yintercept = 2.04, color = "#E7298A", linetype = "dashed") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold")) + guides(color = guide_legend(nrow = 2, byrow = TRUE))
```

## Other Social-Emotional Learning Questions

```{r}
# Belong
a <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(belong)) %>% 
  count(belong) %>% 
  summarise(belong, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = belong)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Tengo la sensación de que encajo aquí", subtitle = "I feel like I belong here") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= scales::percent(Percent)), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")

legend <- get_legend(a + guides(color = guide_legend(nrow = 1)) + theme(legend.position = "bottom"))
```

```{r}
# Trust an Adult 
b <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`voice matters`)) %>% 
  count(`voice matters`) %>% 
  summarise(`voice matters`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `voice matters`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Hay un adulto en la escuela en el que confío", subtitle = "There is an adult I trust at school") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= scales::percent(Percent)), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
# My Voice Matters
c <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`voice matters`)) %>% 
  count(`voice matters`) %>% 
  summarise(`voice matters`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `voice matters`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Mi voz importa en nuestra escuela", subtitle = "My voice matters at our school") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= scales::percent(Percent)), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
# Excited to Learn 
d <- wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`excited to learn`)) %>% 
  count(`excited to learn`) %>% 
  summarise(`excited to learn`, "Total" = n, "Percent" = round(n/sum(n),3)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `excited to learn`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "Me emociona aprender", subtitle = "I feel excited about learning") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= scales::percent(Percent)), position = position_stack(vjust = .5, reverse = T), size =3, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "none")
```

```{r}
a + b + legend + plot_layout(ncol = 1)
```

```{r}
c + d + legend + plot_layout(ncol = 1)
```

### Other SEL Questions Overall Average Growth 
```{r}
#Overall Average SEL Domain 
sel_long %>% 
  filter(!str_detect(domain,paste(c("care", "strategies"),collapse = '|'))) %>% 
  filter(domain != "wants school adult") %>% 
  group_by(domain, quarter) %>% 
  summarise(y= round(mean(score, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = domain, group = domain)) + labs(title= "", x = "", y = "", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~domain) + geom_text(aes(label = y), vjust = -.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

### Other SEL Questions Average Growth by Gender
```{r}
#Overall School Climate by Gender 
sel_long %>% 
  filter(!str_detect(domain,paste(c("care", "strategies"),collapse = '|'))) %>% 
  filter(domain != "wants school adult") %>% 
  filter(!is.na(gender)) %>% 
  group_by(domain, quarter, gender) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,x = "", y = "Average Rating", color= "", subtitle = "dotted lines indicate overall average of Fall and Winter", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + geom_point() + geom_line() + facet_wrap(~gender) + scale_color_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"), legend.position = "bottom") + guides(color = guide_legend(nrow = 2, byrow = TRUE)) + 
  geom_hline(yintercept = 2.21, color = "#1B9E77", linetype = "dashed") + 
  geom_hline(yintercept = 2.10, color = "#D95F02", linetype = "dashed") + 
  geom_hline(yintercept = 2.33, color = "#7570B3", linetype = "dashed") + 
  geom_hline(yintercept = 1.99, color = "#E7298A", linetype = "dashed") 
```

### Other SEL Questions Average Growth by Race
```{r}
#Overall School Climate by Race 
sel_long %>% 
  filter(!str_detect(domain,paste(c("care", "strategies"),collapse = '|'))) %>% 
  filter(domain != "wants school adult") %>% 
  filter(!is.na(race)) %>% 
  group_by(domain, quarter, race) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,x = "", y = "Average Rating", color= "", subtitle = "dotted lines indicate overall average of Fall and Winter", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits=c(0, 3)) + geom_point() + geom_line() + facet_wrap(~race) + scale_color_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"), legend.position = "bottom") + guides(color = guide_legend(nrow = 2, byrow = TRUE)) + 
  geom_hline(yintercept = 2.21, color = "#1B9E77", linetype = "dashed") + 
  geom_hline(yintercept = 2.10, color = "#D95F02", linetype = "dashed") + 
  geom_hline(yintercept = 2.33, color = "#7570B3", linetype = "dashed") + 
  geom_hline(yintercept = 1.99, color = "#E7298A", linetype = "dashed") 
```

### Other SEL Questions Average Growth by Race and Gender
```{r}
#Overall School Climate by Race and Gender
sel_long %>% 
  filter(!str_detect(domain,paste(c("care", "strategies"),collapse = '|'))) %>% 
  filter(domain != "wants school adult") %>% 
  filter(!is.na(race)) %>% 
  filter(!is.na(gender)) %>% 
  group_by(domain, quarter, race, gender) %>% 
  summarise(y= mean(score, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = domain, group = domain)) + labs(title= "" ,x = "", y = "Average Rating", color= "", subtitle = "dotted lines indicate overall average of Fall and Winter", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits=c(0, 3)) + geom_point() + geom_line() + facet_wrap(~race + gender) + scale_color_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"), legend.position = "bottom") + guides(color = guide_legend(nrow = 2, byrow = TRUE)) + 
  geom_hline(yintercept = 2.21, color = "#1B9E77", linetype = "dashed") + 
  geom_hline(yintercept = 2.10, color = "#D95F02", linetype = "dashed") + 
  geom_hline(yintercept = 2.33, color = "#7570B3", linetype = "dashed") + 
  geom_hline(yintercept = 1.99, color = "#E7298A", linetype = "dashed") 
```

# Tengo la sensación de que encajo aquí  
## I feel like I belong here

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(belong, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(belong, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(belong, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating", caption = "Chinese-Mandarin responded 'never' in the Fall, other blank sections were not filled out") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(race != "American Indian or Alaska Native") %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(belong, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```


# Hay un adulto en la escuela en el que confío
## There is an adult I trust at school
```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(trust_adult, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(trust_adult, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(trust_adult, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(trust_adult, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```


# Mi voz importa en nuestra escuela
## My voice matters at our school

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(voice_matters, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(voice_matters, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(voice_matters, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(voice_matters, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```


# Me emociona aprender
## I feel excited about learning

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(excited_to_learn, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(excited_to_learn, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(excited_to_learn, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(excited_to_learn, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```



# Los otros estudiantes se preocupan por mí y me tratan con amabilidad
## Other students care about me and treat me with kindness

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(peers_care, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(peers_care, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(peers_care, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(peers_care, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

# Me preocupo por los demás y los trato con amabilidad
## I care about other students and treat them with kindness

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(i_care_about_peers, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(i_care_about_peers, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(i_care_about_peers, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(i_care_about_peers, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```


# Mis maestros se preocupan por mí y me tratan con amabilidad
## My teachers care about me and treat me with kindness

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(teachers_care, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(teachers_care, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(teachers_care, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(teachers_care, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

# Si quedo atascado/a, elijo una estrategia efectiva para desatascarme
## If I get stuck, I choose an effective strategy to succeed

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(stuck_strategies, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3)) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(stuck_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(stuck_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(stuck_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

# Si estoy molesto/a, elijo una estrategia efectiva para calmarme
## If I feel upset, I choose an effective strategy to calm down

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(upset_strategies, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(upset_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(upset_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(upset_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

# Conozco muchas estrategias para solucionar problemas
## I know many strategies to solve problems

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(problem_solving_strategies, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(problem_solving_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(problem_solving_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(problem_solving_strategies, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

# Comparto con mi familia las estrategias que he aprendido 
## I share the strategies I have learned with my family

```{r}
# Gender 
sel_df %>% 
  filter(!is.na(gender)) %>% 
  group_by(gender, quarter) %>% 
  summarise(y = mean(share_strategies_with_family, na.rm = T)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + scale_color_manual(values=c("#049E64", "#DFB312")) + scale_y_continuous(limits=c(0, 3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + labs(x = "Semester", y = "Average Rating", color= "Gender") + geom_point() + geom_line()
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(share_strategies_with_family, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label = y), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
#Language
sel_df %>% 
  group_by(quarter, home_language) %>% 
  filter(!is.na(home_language)) %>% 
  summarise(y = round(mean(share_strategies_with_family, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = home_language, group = home_language)) + labs(title= "", x = "", y = "Average Rating") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + geom_col() + facet_wrap(~home_language) + geom_text(aes(label = y), vjust = 1.5, size = 3) + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(gender) & !is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(share_strategies_with_family, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, color = gender, group = gender)) + geom_point() + geom_line() + scale_color_manual(values=c("#049E64", "#DFB312")) + facet_wrap(~race + gender) + labs(title= "", x = "", y = "Average Rating", caption = "Nunca = 0, De Vez En Cuando = 1, Casi Siempre = 2, Siempre = 3") + scale_y_continuous(limits = c(0,3), labels = c("Nunca/Never", "De Vez En Cuando/Sometimes", "Casi Siempre/Usually", "Siempre/Always")) + theme(legend.position = "none") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"))
```

# Quiero hablar con un adulto en la escuela sobre cómo me siento 
## I want to talk to an adult at school about how I am feeling

```{r}
 wf %>% 
  group_by(quarter) %>%
  filter(!is.na(`Wants school adult`)) %>% 
  count(`Wants school adult`) %>% 
  summarise(`Wants school adult`, "Total" = n, "Percent" = round(n/sum(n),4)) %>% 
  ggplot(aes(x= quarter, y= Percent, fill = `Wants school adult`)) + geom_col(position = position_stack(reverse = T), width = .5) +
  labs(x = "", y= "", title = "") + scale_fill_brewer(palette = "Dark2") +
  geom_text(aes(label= scales::percent(Percent)), position = position_stack(vjust = .5, reverse = T), size =4, color = "black") + coord_flip() + theme(legend.title = element_blank(), axis.line = element_blank(), axis.ticks = element_blank(),axis.text.x = element_blank(),legend.position = "bottom")
```

```{r}
# By Race
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race) %>% 
  summarise(y = round(mean(wants_school_adult, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "") + scale_y_continuous(limits = c(0,1)) + theme(legend.position = "none") + geom_col() + facet_wrap(~race) + geom_text(aes(label= scales::percent(y)), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"), axis.text.y = element_blank(), axis.line.y = element_blank(), axis.ticks.y = element_blank())
```


```{r}
# Race and Gender 
sel_df %>% 
  filter(!is.na(race)) %>% 
  group_by(quarter, race, gender) %>% 
  summarise(y = round(mean(wants_school_adult, na.rm = T),2)) %>% 
  ggplot(aes(quarter, y, fill = race, group = race)) + labs(title= "", x = "", y = "") + scale_y_continuous(limits = c(0,1)) + theme(legend.position = "none") + geom_col() + facet_wrap(~race + gender) + geom_text(aes(label= scales::percent(y)), vjust = 1.5, size = 3) + scale_fill_brewer(palette = "Dark2") + theme(strip.background = element_blank(), strip.text.x = element_text(face = "bold"), axis.text.y = element_blank(), axis.line.y = element_blank(), axis.ticks.y = element_blank())
```
